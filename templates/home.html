<!DOCTYPE html>
<html>
  <head>
  <title>Home - Fenwick</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  </head>
  <body>
    <div class="main">
      <div class="navbar">
        <h2><a href="/home">Home</a></h2>
        <h2><a href="/profile">Profile</a></h2>
      </div>
      <hr>

      <div class="container">
        <select class="location" name="location" id="locationDropdown" onchange="updateLocationTag()">
          <option class="location"></option>
          <option value="JC" class="location JC2">Johnson Center (JC)</option>
          <option value="Fenwick" class="location Fen4">Fenwick (Fen)</option>
          <option value="Horizon" class="location Horizon">Horizon Hall</option>
          <option value="Planetary" class="location Planetary">Planetary Hall</option>
          <option value="Innovation" class="location Innovation">Innovation Hall</option>
        </select>

        <ul class="card">
          {% for user in users %}
            <li>
              <a href="/user/{{ user.username }}">
                @{{ user.username }}: <span class="location {{ user.loc }}">{{ user.loc }}</span>
              </a>
            </li>
          {% endfor %}
        </ul>
        </div>
    </div>

    <script>
      function updateLocationTag(){
        const location = document.getElementById("locationDropdown").value;

        window.location.href = `/home?location=${encodeURIComponent(location)}`;
        
        /* fetch("/home", {
          method: "GET",
          headers: { "Content-Type": "application/json"},
          body: JSON.stringify({ "location": locationDropdown.value })
        }); */
      }

      function setDropdown(){
        const params = new URLSearchParams(window.location.search);
        const loc = params.get("location");

        const locationDropdown = document.getElementById("locationDropdown");
        locationDropdown.value = loc;
        locationDropdown.className = "location " + loc;
      }
      setDropdown();
    </script>
  </body>
</html>
